/* ══════════════════════════════════════════════════════════
   Variable Manifest Panel — Gutter Tabs + Variable Cards
   ══════════════════════════════════════════════════════════ */

/* ── Gutter Tabs ─────────────────────────────────────── */
.gutter-tabs {
  display: flex;
  gap: 2px;
  flex: 1;
  min-width: 0;
}
.gutter-tab {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 6px 8px;
  border: none;
  border-bottom: 2px solid transparent;
  background: none;
  color: var(--ctp-overlay1);
  font-family: 'DM Sans', sans-serif;
  font-size: 10px;
  font-weight: 600;
  letter-spacing: 0.5px;
  text-transform: uppercase;
  cursor: pointer;
  transition: all 0.15s;
  white-space: nowrap;
}
.gutter-tab i { font-size: 12px; }
.gutter-tab:hover { color: var(--ctp-text); }
.gutter-tab.active {
  color: var(--ctp-blue);
  border-bottom-color: var(--ctp-blue);
}
.gutter-tab-count {
  font-family: 'Victor Mono', monospace;
  font-size: 9px;
  color: var(--ctp-overlay0);
  background: var(--ctp-surface0);
  padding: 0 5px;
  border-radius: 8px;
  min-width: 14px;
  text-align: center;
}
.gutter-tab.active .gutter-tab-count {
  background: var(--ctp-surface1);
  color: var(--ctp-subtext0);
}
/* Light themes: match lighter annotation bubble background */
[data-theme="latte"] .gutter-tab-count,
[data-theme="rose-pine-dawn"] .gutter-tab-count,
[data-theme="tokyo-light"] .gutter-tab-count {
  background: var(--ctp-mantle);
}
[data-theme="latte"] .gutter-tab.active .gutter-tab-count,
[data-theme="rose-pine-dawn"] .gutter-tab.active .gutter-tab-count,
[data-theme="tokyo-light"] .gutter-tab.active .gutter-tab-count {
  background: var(--ctp-surface0);
}

/* ── Variable Cards ──────────────────────────────────── */
.var-card {
  background: var(--ctp-surface0);
  border-radius: 8px;
  padding: 10px 12px;
  margin-bottom: 8px;
  cursor: pointer;
  transition: all 0.2s ease;
  border-left: 3px solid rgba(var(--ctp-mauve-rgb), 0.4);
  animation: annSlideIn 0.2s ease both;
}
.var-card:hover {
  border-left-color: var(--ctp-mauve);
  box-shadow: 0 2px 8px rgba(var(--ctp-mantle-rgb), 0.12);
}
.var-card-header {
  display: flex;
  align-items: center;
  gap: 5px;
  flex-wrap: wrap;
}
.var-card-name {
  font-family: 'Victor Mono', monospace;
  font-size: 11.5px;
  font-weight: 600;
  color: var(--ctp-mauve);
}
.var-card-badge {
  font-family: 'Victor Mono', monospace;
  font-size: 8.5px;
  font-weight: 600;
  padding: 1px 5px;
  border-radius: 6px;
  letter-spacing: 0.3px;
}
.var-card-badge.type-string  { background: rgba(var(--ctp-blue-rgb),0.15); color: var(--ctp-blue); }
.var-card-badge.type-integer { background: rgba(var(--ctp-peach-rgb),0.15); color: var(--ctp-peach); }
.var-card-badge.type-boolean { background: rgba(var(--ctp-green-rgb),0.15); color: var(--ctp-green); }
.var-card-badge.type-unknown { background: rgba(var(--ctp-overlay0-rgb),0.15); color: var(--ctp-overlay0); }
.var-card-badge.required { background: rgba(var(--ctp-red-rgb),0.12); color: var(--ctp-red); }
.var-card-badge.undeclared {
  background: rgba(var(--ctp-red-rgb),0.12);
  color: var(--ctp-red);
  border: 1px dashed rgba(var(--ctp-red-rgb),0.4);
}
.var-card-badge.usage-count {
  background: var(--ctp-surface1);
  color: var(--ctp-subtext0);
}
.var-card-desc {
  font-family: 'DM Sans', sans-serif;
  font-size: 10px;
  color: var(--ctp-overlay1);
  margin-top: 4px;
  line-height: 1.4;
}
.var-card-default {
  font-family: 'Victor Mono', monospace;
  font-size: 9.5px;
  color: var(--ctp-subtext0);
  margin-top: 3px;
}
.var-card-default span { color: var(--ctp-overlay0); }

/* ── Undeclared Section Divider ──────────────────────── */
.var-section-header {
  font-family: 'Victor Mono', monospace;
  font-size: 9px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.8px;
  color: var(--ctp-overlay0);
  padding: 12px 0 6px;
  border-top: 1px solid var(--ctp-surface0);
  margin-top: 8px;
}
.var-section-header.warning { color: var(--ctp-yellow); }

/* ── Variables Toolbar ───────────────────────────────── */
#variables-toolbar {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 0 10px;
  border-bottom: 1px solid var(--ctp-surface0);
  margin-bottom: 10px;
}
.var-fill-toggle {
  display: flex;
  align-items: center;
  gap: 5px;
  padding: 4px 10px;
  border-radius: 6px;
  border: 1px solid var(--ctp-surface1);
  background: none;
  color: var(--ctp-overlay1);
  font-family: 'DM Sans', sans-serif;
  font-size: 10px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s;
}
.var-fill-toggle i { font-size: 12px; }
.var-fill-toggle:hover { border-color: var(--ctp-blue); color: var(--ctp-text); }
.var-fill-toggle.active {
  background: rgba(var(--ctp-blue-rgb),0.12);
  border-color: var(--ctp-blue);
  color: var(--ctp-blue);
}

/* ── Fill-in Inputs ──────────────────────────────────── */
.var-card-input { margin-top: 6px; }
.var-card-input input {
  width: 100%;
  background: var(--ctp-surface1);
  border: 1px solid var(--ctp-surface2);
  color: var(--ctp-text);
  font-family: 'Victor Mono', monospace;
  font-size: 10px;
  padding: 5px 8px;
  border-radius: 4px;
  outline: none;
  box-sizing: border-box;
  transition: border-color 0.15s;
}
.var-card-input input:focus { border-color: var(--ctp-blue); }
.var-card-input input::placeholder { color: var(--ctp-overlay0); }

/* ── Variables Preview Bar ───────────────────────────── */
#variables-preview-bar {
  display: flex;
  gap: 6px;
  padding: 10px 0;
  border-top: 1px solid var(--ctp-surface0);
  margin-top: 10px;
}
.var-preview-btn {
  flex: 1;
  padding: 6px 12px;
  border-radius: 6px;
  border: none;
  font-family: 'DM Sans', sans-serif;
  font-size: 10px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s;
}
.var-preview-btn.primary { background: var(--ctp-blue); color: var(--ctp-base); }
.var-preview-btn.primary:hover { box-shadow: 0 2px 8px rgba(var(--ctp-blue-rgb),0.3); }
.var-preview-btn.ghost {
  background: none;
  color: var(--ctp-overlay1);
  border: 1px solid var(--ctp-surface1);
}
.var-preview-btn.ghost:hover { color: var(--ctp-text); border-color: var(--ctp-overlay0); }

/* ── Variable Preview Overlay ────────────────────────── */
#var-preview-overlay {
  position: fixed;
  inset: 0;
  z-index: 9500;
  background: var(--ctp-base);
  display: flex;
  flex-direction: column;
  animation: fmFadeIn 0.15s ease;
}
#var-preview-overlay .preview-header {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 12px 20px;
  background: var(--ctp-mantle);
  border-bottom: 1px solid var(--ctp-surface0);
}
#var-preview-overlay .preview-title {
  font-family: 'DM Sans', sans-serif;
  font-size: 14px;
  font-weight: 600;
  color: var(--ctp-text);
  flex: 1;
}
#var-preview-overlay .preview-badge {
  font-family: 'Victor Mono', monospace;
  font-size: 10px;
  padding: 2px 8px;
  border-radius: 8px;
  background: rgba(var(--ctp-green-rgb),0.15);
  color: var(--ctp-green);
}
#var-preview-overlay .preview-close {
  background: none;
  border: none;
  color: var(--ctp-overlay1);
  font-size: 18px;
  cursor: pointer;
  padding: 4px;
  border-radius: 4px;
}
#var-preview-overlay .preview-close:hover { color: var(--ctp-text); }
#var-preview-overlay .preview-body {
  flex: 1;
  overflow-y: auto;
  padding: 48px 56px 80px;
  max-width: 900px;
  width: 100%;
  margin: 0 auto;
}

/* ── Variable Pill Highlight Pulse ───────────────────── */
.tpl-var-pill.var-highlight-pulse {
  animation: varPulse 0.8s ease;
  box-shadow: 0 0 0 2px var(--ctp-mauve);
}
.tpl-var-pill[data-syntax="dollar"].var-highlight-pulse {
  box-shadow: 0 0 0 2px var(--ctp-teal);
}
@keyframes varPulse {
  0% { transform: scale(1.12); }
  50% { transform: scale(1.04); }
  100% { transform: scale(1); }
}

/* ── Variable Panel Empty State ──────────────────────── */
.var-hint {
  color: var(--ctp-overlay0);
  font-size: 10px;
  font-family: 'Victor Mono', monospace;
  padding: 20px 8px;
  text-align: center;
  line-height: 1.6;
}
.var-hint code {
  background: var(--ctp-surface0);
  padding: 1px 4px;
  border-radius: 3px;
  font-size: 9.5px;
}

/* ── Latte Overrides ─────────────────────────────────── */
[data-theme="latte"] .var-card { border-left-color: rgba(var(--ctp-mauve-rgb), 0.3); }
[data-theme="latte"] .var-card-badge.type-string { background: rgba(var(--ctp-blue-rgb),0.1); }
[data-theme="latte"] .var-card-badge.type-integer { background: rgba(var(--ctp-peach-rgb),0.1); }
[data-theme="latte"] .var-card-badge.type-boolean { background: rgba(var(--ctp-green-rgb),0.1); }
[data-theme="latte"] .var-card-badge.required { background: rgba(var(--ctp-red-rgb),0.08); }
[data-theme="latte"] .var-card-badge.type-unknown { background: rgba(var(--ctp-overlay0-rgb),0.12); }
[data-theme="latte"] .var-card-badge.undeclared { background: rgba(var(--ctp-red-rgb),0.08); border: 1px dashed rgba(var(--ctp-red-rgb),0.3); }
[data-theme="latte"] .var-fill-toggle.active { background: rgba(var(--ctp-blue-rgb),0.08); }
